<HTML> 
<HEAD>
<p>
<title>Capture of colour pictures using visilog</title>
<b>Neal Snooke</b>
<BODY>
<p>
<p>
<h1>Introduction</h1>
<p>
It is possible to use Zeus and the visilog software to capture 
colour images.  Because of the 8 bit deep frame buffer the 
procedure is divided into several stages, explained in the next sections.
The captured pictures can be converted in to almost any format. eg.
PPM, TIFF, GIF etc.
<p>
<h1>Process overview</h1>
<p>
The entire process is divided into the following stages:
<UL>
<LI> set up the hardware
<LI> capture red, green and blue image components
<LI> combine the RGB files and convert from visilog to a
      more useful single file format
<LI> adjust the colour balance and quantize the colour palette
<LI> store in the format of your choice
\end{itemize</i>
<p>
<h1>Set up the hardware</h1>
<p>
Make sure the following have been performed:
<UL>
<LI> login to Zeus do not run Xwindows !
<LI> Make sure the RGB and sync leads from the colour camera are connected
      to the small grey box (sync generator)
<LI> Make sure the RGB leads from the sync generator lead to
      channels 1, 2, and 3 (red, green, blue <i> resp</i>) on the frame
      buffer card on Zeus.  
<LI> Turn on the camera power supply and sync generator.  The sync generator
      requires a 9V battery to operate.
<LI> Turn on the secondary colour monitor next to Zeus 
\end{itemize</i>
<p>
<h1>Image capture</h1>
<p>
To run visilog you must be in the Suntools window system. Visilog must
also be run from the correct directory.
\begin{verbatim}
Zeus: Suntools
<p>
Zeus: cd /usr/local/visilog/monitor
Zeus: visilog
\end{verbatim}
<p>
If all is well the main visilog window will occupy most of the main
monitor.  Click on the `:256' icon and select an image size of 512.
<p>
To test the camera click on the `GRAB' icon select channel 2, quadrant 4,
and and name, a live video picture will appear on the secondary monitor. 
Answer the `freeze frame' question with your choice (does not matter). 
If no image appears check the brightness controls, camera RGB leads,
power supply and sync box battery (green led should be lit). 
<p>
The strategy now is to capture 3 images, one from each channel, and
then store them to 3 files called `red.cam', `green.cam', `blue,cam'.
It is a good idea to change directory to your home filestore, or failing
that /tmp will do.  To do this click on the `chd' selection from the
`utilities' menu (default).
<p>
A file exists that will force visilog to automatically capture the 
required images and write them to the current directory.  Available
from <b> ~nns/vlog/capture.j</b>. Click on the `PLAY' selection and specify
this file.  Visilog will prompt for continuous or step by step play, -
if the first image flickers when using continuous then use step-by-step.
(continuous usually works, but not always ??)
<p>
<h1>Image Conversion</h1>
<p>
Assuming you now have three files (called `red.cam', `green.cam', `blue.cam'
these should be 262144 bytes each) you can run a small program called
<b> ~nns/vlog/cam2ppm</b> to merge these into a single file which will be 
in the .PPM
format.  You will need another shell window to perform the conversion.
\begin{verbatim}
MACHINE% cam2ppm > myfile.ppm
\end{verbatim}
<p>
Theoretically the image is now ready for use.  However it will usually
have slightly odd colour characteristics, due to the lighting etc.  Also
the 24 bit colour will need to be quantized to 8 bits for most displays.
<p>
The best way to achieve this is to use <b> xv</b>.  Load the created image
and select `COL EDIT' where the colour components, intensity, contrast
etc can be adjusted via a very nice graphical interface.
The file can subsequently
be written in the format of your choice with the 'SAVE' menu.  The image
can also be cropped if the edges are poor.
<p>
The output file will be considerably smaller (PPM, GIF, TIFF) due to the colour 
quantization performed by <b> xv</b>.  Beware of postscript as the resulting file
could be MASSIVE 1-2Mb.
<p>
As <b> xv</b> cannot be run in sunview (!) you must either quit visilog and 
sunview
and run X or log on to another machine to play with the image.
</BODY>
